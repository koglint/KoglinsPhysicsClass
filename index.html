import { setDoc, getDoc, doc } from "https://www.gstatic.com/firebasejs/9.6.10/firebase-firestore.js";

export async function saveTaskProgress(uid, tasks) {
  try {
    await setDoc(doc(db, "tasks", uid), { tasks });
    console.log("Task progress saved successfully.");
  } catch (error) {
    console.error("Error saving task progress:", error);
  }
}

export async function loadTaskProgress(uid) {
  try {
    const docRef = doc(db, "tasks", uid);
    const docSnap = await getDoc(docRef);
    if (docSnap.exists()) {
      const tasks = docSnap.data().tasks;
      for (const [key, value] of Object.entries(tasks)) {
        for (const [task, checked] of Object.entries(value)) {
          document.getElementById(`${task}-${key.split(" ")[2]}`).checked = checked;
        }
      }
    } else {
      console.log("No task progress found.");
    }
  } catch (error) {
    console.error("Error loading task progress:", error);
  }
}
